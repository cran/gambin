<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Thomas J. Matthews and Colin Gillespie" />


<title>Gambin overview</title>

<script>// Hide empty <a> tag within highlighted CodeBlock for screen reader accessibility (see https://github.com/jgm/pandoc/issues/6352#issuecomment-626106786) -->
// v0.0.1
// Written by JooYoung Seo (jooyoung@psu.edu) and Atsushi Yasumoto on June 1st, 2020.

document.addEventListener('DOMContentLoaded', function() {
  const codeList = document.getElementsByClassName("sourceCode");
  for (var i = 0; i < codeList.length; i++) {
    var linkList = codeList[i].getElementsByTagName('a');
    for (var j = 0; j < linkList.length; j++) {
      if (linkList[j].innerHTML === "") {
        linkList[j].setAttribute('aria-hidden', 'true');
      }
    }
  }
});
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Gambin overview</h1>
<h4 class="author">Thomas J. Matthews and Colin Gillespie</h4>



<div id="overview" class="section level1">
<h1>Overview</h1>
<p>The gambin distribution is a sample distribution based on a stochastic model of species abundances, and has been demonstrated to fit empirical data better than the most commonly used species-abundance distribution (SAD) models (see <span class="citation">Matthews et al. (2014)</span> and <span class="citation">Ugland et al. (2007)</span>). Gambin is a stochastic model which combines the gamma distribution with a binomial sampling method. To fit the gambin distribution, the abundance data is first binned into octaves using a simple log2 transform that doubles the number of abundance classes within each octave. Thus, octave 0 contains the number of species with 1 individual, octave 1 the number of species with 2 or 3 individuals, octave 2 the number of species with 4 to 7 individuals, and so forth (method 3 in <span class="citation">Gray, Bjorgesaeter, and Ugland (2006)</span>).</p>
<p>The gambin distribution is flexible, meaning it can fit a variety of empirical SAD shapes (including lognormal and logseries-like shapes), and that the distribution shape (in the context of the unimodal gambin model) is adequately characterised by the model’s single parameter (α): low values of alpha indicate logserieslike SADs, and high alpha values indicate lognormal-like SADs. As such, the alpha parameter can be used as a metric to compare the shape of SADs from different ecological communities; for example, along an environmental gradient (e.g <span class="citation">Arellano et al. (2017)</span>)</p>
<p>The expected abundance octave of a species is given by the number of successfull consecutive Bernoulli trials with a given parameter <span class="math inline">\(p\)</span>. The parameter <span class="math inline">\(p\)</span> of species is assumed to distributed according to a gamma distribution. This approach can be viewed as linking the gamma distribution with the probability of success in a binomial process with <span class="math inline">\(x\)</span> trials. Use the fit_abundances() function to fit the gambin model to a vector of species abundances, optionally using a subsample of the individuals. The package estimates the alpha (shape) parameter with associated confidence intervals. Methods are provided for plotting the results, and for calculating the likelihood of fits. The summary() function provides the confidence intervals around alpha, and also the results of a X2 goodness of fit test. Prior to package version 2.4.4, we simply used the default degrees of freedom in this test (i.e. number of data points - 1). This is not optimal as the degrees of freedom should arguably also include the number of parameters used to fit the gambin model itself. As such, in version 2.4.4 we have edited the degrees of freedom to reflect this. One problem is that the chisq.test() function in R does not have an argument for setting the degrees of freedom; thus, we have had to use a workaround. As a result of this change, X2 results generated using older versions of the package will differ slightly from those using 2.4.4 and later.</p>
<p>It has become increasingly apparent that many empirical SADs are in fact multimodal (<span class="citation">Antao et al. (2017)</span>). As such, recent work has focused on expanding the standard unimodal gambin model to allow it to fit distributions with multiple modes (<span class="citation">Matthews et al. (2019)</span>). For example, the bimodal gambin model can be calculated as the integration of two gambin distributions. The corresponding likelihood function for the bimodal gambin model contain’s four parameters: the shape parameters for the first and second group, the max octave of the first group (as this is allowed to vary), and one splitting parameter (split) representing the fraction of objects in the first group.It is relatively straightforward to extend the above approach for fitting the bimodal gambin model by maximum likelihood, to fitting gambin models with g modes. For each additional mode, a further three parameters are needed: the additional alpha, max octave and split parameters (see <span class="citation">Matthews et al. (2019)</span>). Use the fit_abundances() function in combination with the no_of_components of argument. The default is no_of_components = 1, which fits the standard unimodal gambin model. no_of_components = 2, fits the bimodal gambin model, and so on. As the optimisation procedure takes long with no_of_components &gt; 1, it is possible to use the cores argument within fit_abundances to make use of parallel processing in the maximum likelihood optimisation.</p>
<p>The deconstruct_modes() function can then be used to examine a multimodal gambin model fit. The function provides the location of the modal octaves of each component distribution and (if species classification data are provided) determines the proportion of different types of species in each octave.</p>
<p>Often the aim of SAD studies is to compare the form of the SAD across different sites / samples. The alpha parameter of the one component gambin model (alpha) has been found to provide a useful metric in this regard. Use the mult_abundances() function to calculate alpha values for a set of different samples / sites. However, because the alpha parameter of the gambin model is dependent on sample size, when comparing the alpha values between sites it can be useful to first standardise the number of individuals in all sites. By default, the mult_abundances() function calculates the total number of individuals in each site and selects the minimum value for standardising. This minimum number of individuals is then sampled from each site and the gambin model fitted to this subsample and the alpha value stored. This process is then repeated N times and the mean alpha value is calculated for each site.</p>
<div id="example" class="section level2">
<h2>Example</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw">library</span>(<span class="st">&quot;gambin&quot;</span>)</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="kw">data</span>(moths, <span class="dt">package=</span><span class="st">&quot;gambin&quot;</span>)</span>
<span id="cb1-3"><a href="#cb1-3"></a></span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="co">##unimodal model</span></span>
<span id="cb1-5"><a href="#cb1-5"></a>fit =<span class="st"> </span><span class="kw">fit_abundances</span>(moths)</span>
<span id="cb1-6"><a href="#cb1-6"></a>fit<span class="op">$</span>alpha</span></code></pre></div>
<pre><code>## [1] 1.644694</code></pre>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="kw">barplot</span>(fit)</span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="kw">points</span>(fit)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="kw">AIC</span>(fit)</span></code></pre></div>
<pre><code>## [1] 803.6409</code></pre>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="co">##unimodal model (fit to a subsample of 1000 individuals)</span></span>
<span id="cb6-2"><a href="#cb6-2"></a>fit2 =<span class="st"> </span><span class="kw">fit_abundances</span>(moths, <span class="dt">subsample =</span> <span class="dv">1000</span>)</span>
<span id="cb6-3"><a href="#cb6-3"></a>fit2<span class="op">$</span>alpha</span></code></pre></div>
<pre><code>## [1] 0.8904631</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="kw">barplot</span>(fit2)</span>
<span id="cb8-2"><a href="#cb8-2"></a><span class="kw">points</span>(fit2)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="kw">AIC</span>(fit2)</span></code></pre></div>
<pre><code>## [1] 394.7729</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="co">##bimodal model (using 3 cores)</span></span>
<span id="cb11-2"><a href="#cb11-2"></a></span>
<span id="cb11-3"><a href="#cb11-3"></a><span class="co">#simulate bimodal gambin distribution</span></span>
<span id="cb11-4"><a href="#cb11-4"></a>x1 =<span class="st"> </span><span class="kw">rgambin</span>(<span class="dv">600</span>, <span class="dv">5</span>, <span class="dv">10</span>)</span>
<span id="cb11-5"><a href="#cb11-5"></a>x2 =<span class="st"> </span><span class="kw">rgambin</span>(<span class="dv">300</span>, <span class="dv">1</span>, <span class="dv">10</span>)</span>
<span id="cb11-6"><a href="#cb11-6"></a>x =<span class="st"> </span><span class="kw">table</span>(<span class="kw">c</span>(x1,x2))</span>
<span id="cb11-7"><a href="#cb11-7"></a>freq =<span class="st"> </span><span class="kw">as.vector</span>(x)</span>
<span id="cb11-8"><a href="#cb11-8"></a>values =<span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">as.character</span>(<span class="kw">names</span>(x)))</span>
<span id="cb11-9"><a href="#cb11-9"></a>abundances =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">octave=</span>values, <span class="dt">species =</span> freq)</span>
<span id="cb11-10"><a href="#cb11-10"></a></span>
<span id="cb11-11"><a href="#cb11-11"></a><span class="co">#fit bimodal model to simulated data</span></span>
<span id="cb11-12"><a href="#cb11-12"></a>fit3 =<span class="st"> </span><span class="kw">fit_abundances</span>(abundances, <span class="dt">no_of_components =</span> <span class="dv">2</span>, <span class="dt">cores =</span> <span class="dv">1</span>)</span></code></pre></div>
<pre><code>## Using 1 core. Your machine has 12 available.</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="kw">barplot</span>(fit3)</span>
<span id="cb13-2"><a href="#cb13-2"></a><span class="kw">points</span>(fit3)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a><span class="kw">AIC</span>(fit3)</span></code></pre></div>
<pre><code>## [1] 4062.259</code></pre>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a><span class="co">#compare with AIC of unimodal model</span></span>
<span id="cb16-2"><a href="#cb16-2"></a><span class="kw">AIC</span>(<span class="kw">fit_abundances</span>(abundances))</span></code></pre></div>
<pre><code>## [1] 4087.551</code></pre>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a><span class="co">#fit a bimodal model to a species classification dataset</span></span>
<span id="cb18-2"><a href="#cb18-2"></a><span class="co">#and calculate the number of the differet categories in each octave</span></span>
<span id="cb18-3"><a href="#cb18-3"></a><span class="kw">data</span>(categ, <span class="dt">package=</span><span class="st">&quot;gambin&quot;</span>)</span>
<span id="cb18-4"><a href="#cb18-4"></a>fits2 =<span class="st"> </span><span class="kw">fit_abundances</span>(categ<span class="op">$</span>abundances, <span class="dt">no_of_components =</span> <span class="dv">2</span>)</span></code></pre></div>
<pre><code>## Using 1 core. Your machine has 12 available.</code></pre>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a>d1 &lt;-<span class="st"> </span><span class="kw">deconstruct_modes</span>(fits2, <span class="dt">dat =</span> categ, <span class="dt">peak_val =</span> <span class="ot">NULL</span>, <span class="dt">abundances =</span> <span class="st">&quot;abundances&quot;</span>, </span>
<span id="cb20-2"><a href="#cb20-2"></a>     <span class="dt">species =</span> <span class="st">&quot;species&quot;</span>, <span class="dt">categ =</span> <span class="st">&quot;status&quot;</span>, <span class="dt">col.statu =</span> <span class="kw">c</span>(<span class="st">&quot;green&quot;</span>, <span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>),</span>
<span id="cb20-3"><a href="#cb20-3"></a>     <span class="dt">plot_legend =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a><span class="co">#do the same but don&#39;t provide category data - this just highlights the modal octaves</span></span>
<span id="cb21-2"><a href="#cb21-2"></a>d2 &lt;-<span class="st"> </span><span class="kw">deconstruct_modes</span>(fits2, <span class="dt">dat =</span> categ, <span class="dt">peak_val =</span> <span class="ot">NULL</span>, <span class="dt">abundances =</span> <span class="st">&quot;abundances&quot;</span>, </span>
<span id="cb21-3"><a href="#cb21-3"></a>     <span class="dt">species =</span> <span class="st">&quot;species&quot;</span>, <span class="dt">categ =</span> <span class="ot">NULL</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="references" class="section level2 unnumbered">
<h2>References</h2>
<div id="refs" class="references">
<div id="ref-antao2017">
<p>Antao, Laura H., Sean R. Connolly, Anne E. Magurran, Amadeu Soares, and Maria Dornelas. 2017. “Prevalence of Multimodal Species Abundance Distributions Is Linked to Spatial and Taxonomic Breadth.” <em>Global Ecology and Biogeography</em> 26 (2): 203–15. <a href="https://doi.org/10.1111/geb.12532">https://doi.org/10.1111/geb.12532</a>.</p>
</div>
<div id="ref-arellano2017">
<p>Arellano, Gabriel, Maria N. Umana, Manuel J. Macía, M. Isabel Loza, Alfredo Fuentes, Victoria Cala, and Peter M. Jorgensen. 2017. “The Role of Niche Overlap, Environmental Heterogeneity, Landscape Roughness and Productivity in Shaping Species Abundance Distributions Along the Amazon–Andes Gradient.” <em>Global Ecology and Biogeography</em> 26 (2): 191–202.</p>
</div>
<div id="ref-gray2006">
<p>Gray, John S., Anders Bjorgesaeter, and Karl. I. Ugland. 2006. “On Plotting Species Abundance Distributions.” <em>Journal of Animal Ecology</em> 75 (3): 752–56.</p>
</div>
<div id="ref-Matthews2019">
<p>Matthews, Thomas J., Michael K. Borregaard, Colin S. Gillespie, Francois Rigal, Karl I. Ugland, Rodrigo Ferreira Kruger, Roberta Marques, et al. 2019. “Extension of the Gambin Model to Multimodal Species Abundance Distributions.” Journal Article. <em>Methods in Ecology and Evolution</em> 10: 432–37. <a href="https://doi.org/doi:10.1111/2041-210X.13122">https://doi.org/doi:10.1111/2041-210X.13122</a>.</p>
</div>
<div id="ref-matthews2014gambin">
<p>Matthews, Thomas J, Michael K Borregaard, Karl I Ugland, Paulo AV Borges, Francois Rigal, Pedro Cardoso, and Robert J Whittaker. 2014. “The Gambin Model Provides a Superior Fit to Species Abundance Distributions with a Single Free Parameter: Evidence, Implementation and Interpretation.” <em>Ecography</em> 37 (10): 1002–11.</p>
</div>
<div id="ref-ugland2007modelling">
<p>Ugland, Karl I, P John D Lambshead, Brian McGill, John S Gray, Niall O’Dea, Richard J Ladle, and Robert J Whittaker. 2007. “Modelling Dimensionality in Species Abundance Distributions: Description and Evaluation of the Gambin Model.” <em>Evolutionary Ecology Research</em> 9 (2): 313–24.</p>
</div>
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
